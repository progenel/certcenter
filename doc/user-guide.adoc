:toc-title: Содержание
= Руководство пользователя по ролям
:toc:
:doctype: article

== Роли и возможности

=== Администратор
* Управление пользователями (создание) и ролями (демо роли создаются автоматически).
* Публикация chain/CRL (в MVP — через артефакты в локальном хранилище).
* Базовые настройки (JWT секреты, путь к хранилищу).

=== Офицер безопасности / криптоофицер
* Выпуск/продление/отзыв сертификатов для подписи/шифрования/VPN.
* Одобрение/отклонение заявок на сертификаты.
* Контроль CRL (OCSP — вне MVP).
* Проверка статуса сертификатов (CRL/статус-API).

=== Сотрудник (пользователь)
* Запрос сертификатов (CSR или серверная генерация, PKCS#12 при серверной).
* Загрузка цепочки/CRL.
* Шифрование файлов (envelope) для других пользователей, скачивание пакетов; загрузка собственного публичного ключа для входящих пакетов.
* Расшифрование полученных пакетов своим закрытым ключом.
* Просмотр своих сертификатов и статусов (через заявки и артефакты).

=== Аудитор
* Проверка доступности CRL/chain (если опубликованы). Полный аудит — за рамками MVP.

== Минимальные сценарии по ролям
* Администратор: создает пользователя, выдает ему роль, проверяет наличие chain/CRL в артефактах.
* Офицер безопасности: одобряет заявку, выпускает/отзывает сертификат, проверяет статус по CRL.
* Сотрудник: загружает свой публичный ключ (или получает сертификат), шифрует файл на коллег, расшифровывает полученный пакет, скачивает chain/CRL.
* Аудитор: проверяет наличие опубликованных CRL/chain.

== Если LDAP/AD не настроен (MVP)
* Используются локальные учетные записи в БД.
* Администратор заводит пользователей вручную.
* Логин — через локальные учетные данные; роли назначаются администратором.

== Где что искать
* Портал/CLI: заявки на сертификаты, шифрование/расшифрование, chain/CRL.
* Документация: `doc/api.adoc`, `doc/mvp.adoc`, `doc/tz.adoc`, `doc/glossary.adoc`.
* Диаграммы: `doc/c4-containers.puml`, `doc/sequence-issue-cert.puml`, `doc/sequence-envelope.puml`.

== Быстрый сценарий в UI
* Войти как `user/user` → загрузить свой публичный ключ (раздел «Шифрование / Расшифрование»).
* Создать заявку на сертификат (профиль подпись/шифрование/VPN); офицер/админ в своем логине одобряет заявку.
* Скачивать chain/CRL (артефакты) — раздел «Артефакты».
* Зашифровать файл на коллег (указать их username/серийный номер cert), скачать конверт.
* Расшифровать конверт, введя свой закрытый ключ (PEM) и, при необходимости, пароль.
